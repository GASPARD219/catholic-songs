<!DOCTYPE html>
<html lang="rw">
<head>
    <link rel="icon" type="image/png" href="logo.png">
    <meta name="title" content="RWANDAN CATHOLIC MUSICIAN">
    <meta name="description" content="IYI WEBSITE IDUFASHA KUBONA INDIRIMBO">
    <meta name="keywords" content="indirimbo, music, Rwanda, website">
    <meta name="author" content="Gaspard GASANGWA">
    <meta property="og:title" content="RWANDAN CATHOLIC">
    <meta property="og:description" content="Ibisobanuro bya website yawe">
    <meta property="og:image" content="https://GASPARD219.github.io/repository-name/logo.png">
    <meta property="og:url" content="https://GASPARD219.github.io/repository-name/">
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="RWANDAN CATHOLIC MUSICIAN">
    
    <title>INDIRIMBO ZA GATOLIKA</title>
    
    <!-- PWA META TAGS -->
    <meta name="theme-color" content="#4b0082">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="manifest" href="./manifest.json">
    <link rel="icon" href="./icons/icon-192.png">
    
    <style>
        /* ===== ORIGINAL STYLES - FULLY PRESERVED ===== */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        header {
            background: linear-gradient(135deg, #4b0082, #6a5acd);
            color: white;
            padding: 25px 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        header h1 {
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        #songCount {
            margin-top: 15px;
            font-size: 16px;
            opacity: 0.9;
            background: rgba(255,255,255,0.1);
            display: inline-block;
            padding: 8px 20px;
            border-radius: 25px;
        }
        
        /* ===== LANGUAGE SWITCHER (TOP RIGHT) ===== */
        .lang-switch {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 6px;
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 40px;
            backdrop-filter: blur(4px);
            z-index: 200;
        }
        .lang-btn {
            background: transparent;
            border: 1px solid white;
            color: white;
            padding: 6px 14px;
            border-radius: 30px;
            font-size: 13px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
        }
        .lang-btn.active {
            background: white;
            color: #4b0082;
            border-color: white;
        }
        .lang-btn:hover {
            background: white;
            color: #4b0082;
        }
        
        /* ===== SEARCH & NAVIGATION (ORIGINAL) ===== */
        .search-box {
            text-align: center;
            padding: 25px 20px;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .search-box input {
            flex: 2;
            min-width: 250px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        .search-box select {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            background: white;
        }
        .search-box button {
            padding: 15px 25px;
            background: #4b0082;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        #sectionNav {
            background: linear-gradient(135deg, #6a5acd, #9370db);
            padding: 15px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            position: sticky;
            top: 140px;
            z-index: 99;
        }
        #sectionNav button {
            padding: 12px 20px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 25px;
            font-weight: bold;
            transition: 0.3s;
            white-space: nowrap;
        }
        #sectionNav button:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        .section {
            display: none;
            padding: 40px 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        .section h2 {
            color: #4b0082;
            border-bottom: 3px solid #4b0082;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        .songs-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 25px;
        }
        .song {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 6px solid #4b0082;
        }
        .song-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        .song-title {
            color: #333;
            margin: 0;
            font-size: 22px;
            flex: 1;
        }
        .song-meta {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .song-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        .download-btn, .play-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 25px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            gap: 8px;
        }
        .download-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }
        .play-btn {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
        }
        .no-songs {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 60px;
            grid-column: 1 / -1;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ===== BOTTOM ADMIN & CONTACT SECTION (MOVED TO BOTTOM) ===== */
        .bottom-admin-section {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px 20px;
            margin-top: 50px;
            text-align: center;
            border-top: 5px solid #4b0082;
        }
        .bottom-admin-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            gap: 30px;
        }
        .admin-card, .contact-card {
            background: rgba(255,255,255,0.1);
            padding: 25px;
            border-radius: 20px;
            flex: 1 1 300px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        .admin-card h3, .contact-card h3 {
            color: #ffd700;
            margin-top: 0;
            font-size: 24px;
            border-bottom: 2px solid #ffd700;
            display: inline-block;
            padding-bottom: 10px;
        }
        .bottom-btn {
            background: #4b0082;
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 0;
            transition: 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            border: 2px solid transparent;
        }
        .bottom-btn:hover {
            background: #5a0d9c;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            border-color: white;
        }
        .contact-info {
            text-align: left;
            margin-top: 15px;
            color: #ecf0f1;
            line-height: 1.8;
        }
        
        /* ===== CONTACT MODAL (ORIGINAL) ===== */
        .modal {
            display: none;
            position: fixed;
            z-index: 10001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: white;
            padding: 35px;
            border-radius: 25px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }
        .modal-content h3 {
            color: #4b0082;
            margin-top: 0;
            border-bottom: 3px solid #6a5acd;
            padding-bottom: 15px;
        }
        .modal-content input, .modal-content textarea {
            width: 100%;
            padding: 14px;
            margin: 12px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
        }
        .modal-content textarea {
            min-height: 120px;
        }
        .send-btn {
            background: #4b0082;
            color: white;
            padding: 14px 25px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            margin-right: 10px;
        }
        .close-btn {
            background: #6c757d;
            color: white;
            padding: 14px 25px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
        }
        
        /* ===== FULL MISS SECTIONS LIST ===== */
        .full-sections-list {
            background: white;
            padding: 30px;
            margin: 30px auto;
            max-width: 1300px;
            border-radius: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .full-sections-list h3 {
            color: #4b0082;
            font-size: 28px;
            text-align: center;
            border-bottom: 3px solid #4b0082;
            padding-bottom: 15px;
        }
        .sections-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }
        .section-badge {
            background: #f0e6ff;
            color: #4b0082;
            padding: 12px 18px;
            border-radius: 40px;
            text-align: center;
            font-weight: 600;
            border: 1px solid #d0bfff;
            transition: 0.2s;
        }
        .section-badge:hover {
            background: #4b0082;
            color: white;
            transform: scale(1.02);
        }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            header h1 { font-size: 1.8em; }
            .search-box { flex-direction: column; }
            #sectionNav { top: 200px; }
            .songs-list { grid-template-columns: 1fr; }
            .lang-switch { position: static; justify-content: center; margin-top: 10px; }
            .bottom-admin-container { flex-direction: column; }
        }
    </style>
</head>
<body>

<!-- ===== LANGUAGE SWITCHER (4 LANGUAGES) ===== -->
<div class="lang-switch" id="globalLangSwitch">
    <button class="lang-btn" data-lang="rw" onclick="setLanguage('rw')">Kinyarwanda</button>
    <button class="lang-btn" data-lang="fr" onclick="setLanguage('fr')">Fran√ßais</button>
    <button class="lang-btn" data-lang="sw" onclick="setLanguage('sw')">Kiswahili</button>
    <button class="lang-btn" data-lang="en" onclick="setLanguage('en')">English</button>
</div>

<!-- ===== HEADER (ORIGINAL - WITHOUT ADMIN/CONTACT BUTTONS) ===== -->
<header>
    <h1 id="appTitle">INDIRIMBO ZA GATOLIKA</h1>
    <p id="songCount">SHAKA INDIRIMBO UKURIKIJE IZINA CYANGWA IGICE CYA MISSA</p>
    <!-- Admin & Contact buttons REMOVED from header - moved to bottom -->
</header>

<!-- ===== SEARCH & FILTER (ORIGINAL) ===== -->
<div class="search-box">
    <input type="text" id="searchInput" placeholder="Shaka indirimbo ku izina..." oninput="searchSongs()" autocomplete="off">
    <select id="sectionFilter" onchange="filterBySection()">
        <option value="">-- Shaka ukurikije igice --</option>
        <option>Gutangira</option>
        <option>Nyagasani Tubabarire</option>
        <option>Imana nisingizwe mu ijuru</option>
        <option>Zaburi</option>
        <option>Alleluya</option>
        <option>Indanga kwemera</option>
        <option>Ibisabisho</option>
        <option>Gutura</option>
        <option>Nyirubutagatifu</option>
        <option>Ntama w'Imana</option>
        <option>Gusangira</option>
        <option>Gushimira</option>
        <option>Gusoza</option>
        <option>Bikiramariya</option>
        <option>Abatagatifu bose</option>
        <option>Gushyingirwa</option>
        <option>Ibitaramo</option>
        <option>Adiventi</option>
        <option>Noheli</option>
        <option>Igisibo</option>
        <option>Pasika</option>
        <option>Asensiyo</option>
        <option>Rohomutagatifu</option>
        <option>Other More songs</option>
    </select>
    <button onclick="clearFilters()" id="resetBtn">Subira</button>
</div>

<!-- ===== SECTION NAVIGATION (ALL MISS SECTIONS) ===== -->
<nav id="sectionNav">
    <!-- Dynamically filled with ALL sections from the code -->
</nav>

<!-- ===== SONGS CONTAINER (DYNAMIC) ===== -->
<div id="sectionsContainer">
    <!-- Songs will be displayed here -->
</div>

<!-- ===== FULL DISPLAY OF ALL MISSA SECTIONS (AS REQUESTED) ===== -->
<div class="full-sections-list" id="allSectionsDisplay">
    <h3 id="allSectionsTitle">IBICE BYA MISSA ZOSE</h3>
    <div class="sections-grid" id="sectionsGrid">
        <!-- Will be populated with all 24+ sections from the original list -->
    </div>
</div>

<!-- ===== BOTTOM SECTION: ADMIN LOGIN & CONTACT US (MOVED HERE) ===== -->
<div class="bottom-admin-section">
    <div class="bottom-admin-container">
        <!-- Admin Login Card -->
        <div class="admin-card">
            <h3 id="adminCardTitle">üîê Admin Login</h3>
            <p id="adminCardDesc" style="margin-bottom:20px;">Injira nka admin ushyireho indirimbo nshya</p>
            <button class="bottom-btn" onclick="window.location.href='admin.html'">
                <span>üîë</span> <span id="adminBtnText">Injira nk'Admin</span>
            </button>
        </div>
        
        <!-- Contact Us Card -->
        <div class="contact-card">
            <h3 id="contactCardTitle">üìû Twandikire</h3>
            <p id="contactCardDesc" style="margin-bottom:15px;">Ufite ikibazo cyangwa igitekerezo? Twandikire ubutumwa</p>
            <button class="bottom-btn" onclick="showContactModal()">
                <span>‚úâÔ∏è</span> <span id="contactBtnText">Ohereza ubutumwa</span>
            </button>
            <div class="contact-info" id="contactInfoText">
                <span>üìß gaspardgasangwa76@gmail.com</span><br>
                <span>üìû +250 792 680 361</span>
            </div>
        </div>
    </div>
</div>

<!-- ===== CONTACT MODAL (ORIGINAL) ===== -->
<div id="contactModal" class="modal">
    <div class="modal-content">
        <h3 id="modalTitle">Twandikire</h3>
        <input type="email" id="contactEmail" placeholder="Imeyili yawe">
        <textarea id="contactMessage" placeholder="Andika ubutumwa"></textarea>
        <button class="send-btn" onclick="sendMessage()" id="sendBtn">Ohereza</button>
        <button class="close-btn" onclick="closeContactModal()" id="closeBtn">Funga</button>
    </div>
</div>

<!-- ===== PWA NOTIFICATION ===== -->
<div id="pwaNotification" class="pwa-notification" style="display:none;">
    <span id="pwaMessage"></span>
    <button onclick="hidePWANotification()">OK</button>
</div>

<script>
    // ========== 4-LANGUAGE TRANSLATIONS (Kinyarwanda, French, Kiswahili, English) ==========
    const translations = {
        rw: {
            appTitle: "INDIRIMBO ZA GATOLIKA",
            songCount: "SHAKA INDIRIMBO UKURIKIJE IZINA CYANGWA IGICE CYA MISSA",
            searchPlaceholder: "Shaka indirimbo ku izina...",
            filterPlaceholder: "-- Shaka ukurikije igice --",
            reset: "Subira",
            allSectionsTitle: "IBICE BYA MISSA ZOSE",
            adminCardTitle: "üîê Admin Login",
            adminCardDesc: "Injira nka admin ushyireho indirimbo nshya",
            adminBtnText: "Injira nk'Admin",
            contactCardTitle: "üìû Twandikire",
            contactCardDesc: "Ufite ikibazo cyangwa igitekerezo? Twandikire ubutumwa",
            contactBtnText: "Ohereza ubutumwa",
            contactInfo: "üìß gaspardgasangwa76@gmail.com\nüìû +250 792 680 361",
            modalTitle: "Twandikire",
            emailPlaceholder: "Imeyili yawe",
            messagePlaceholder: "Andika ubutumwa",
            send: "Ohereza",
            close: "Funga",
            messageSent: "Ubutumwa bwawe bwoherejwe! Murakoze."
        },
        fr: {
            appTitle: "CHANTS CATHOLIQUES",
            songCount: "RECHERCHER UN CHANT PAR NOM OU SECTION",
            searchPlaceholder: "Rechercher un chant...",
            filterPlaceholder: "-- Filtrer par section --",
            reset: "R√©initialiser",
            allSectionsTitle: "TOUTES LES SECTIONS DE LA MESSE",
            adminCardTitle: "üîê Admin Login",
            adminCardDesc: "Connectez-vous en tant qu'admin pour ajouter des chants",
            adminBtnText: "Connexion Admin",
            contactCardTitle: "üìû Contactez-nous",
            contactCardDesc: "Des questions ou suggestions? Envoyez-nous un message",
            contactBtnText: "Envoyer un message",
            contactInfo: "üìß gaspardgasangwa76@gmail.com\nüìû +250 792 680 361",
            modalTitle: "Contactez-nous",
            emailPlaceholder: "Votre email",
            messagePlaceholder: "√âcrivez votre message",
            send: "Envoyer",
            close: "Fermer",
            messageSent: "Message envoy√©! Merci."
        },
        sw: {
            appTitle: "NYIMBO ZA KIKATOLIKI",
            songCount: "TAFUTA WIMBO KWA JINA AU SEHEMU YA MISA",
            searchPlaceholder: "Tafuta wimbo...",
            filterPlaceholder: "-- Chuja kwa sehemu --",
            reset: "Weka upya",
            allSectionsTitle: "SEHEMU ZOTE ZA MISA",
            adminCardTitle: "üîê Admin Login",
            adminCardDesc: "Ingia kama admin kupakia nyimbo mpya",
            adminBtnText: "Ingia kama Admin",
            contactCardTitle: "üìû Wasiliana nasi",
            contactCardDesc: "Una swali au maoni? Tutumie ujumbe",
            contactBtnText: "Tuma ujumbe",
            contactInfo: "üìß gaspardgasangwa76@gmail.com\nüìû +250 792 680 361",
            modalTitle: "Wasiliana nasi",
            emailPlaceholder: "Barua pepe yako",
            messagePlaceholder: "Andika ujumbe",
            send: "Tuma",
            close: "Funga",
            messageSent: "Ujumbe wako umetumwa! Asante."
        },
        en: {
            appTitle: "CATHOLIC HYMNS",
            songCount: "SEARCH HYMNS BY NAME OR MASS SECTION",
            searchPlaceholder: "Search hymns...",
            filterPlaceholder: "-- Filter by section --",
            reset: "Reset",
            allSectionsTitle: "ALL MASS SECTIONS",
            adminCardTitle: "üîê Admin Login",
            adminCardDesc: "Login as admin to upload new hymns",
            adminBtnText: "Admin Login",
            contactCardTitle: "üìû Contact Us",
            contactCardDesc: "Questions or feedback? Send us a message",
            contactBtnText: "Send message",
            contactInfo: "üìß gaspardgasangwa76@gmail.com\nüìû +250 792 680 361",
            modalTitle: "Contact Us",
            emailPlaceholder: "Your email",
            messagePlaceholder: "Write your message",
            send: "Send",
            close: "Close",
            messageSent: "Your message has been sent! Thank you."
        }
    };

    // Current language
    let currentLang = localStorage.getItem('preferredLang') || 'rw';

    // ========== LANGUAGE SETTER ==========
    function setLanguage(lang) {
        currentLang = lang;
        localStorage.setItem('preferredLang', lang);
        applyTranslations();
        // Update active class on lang buttons
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.lang === lang);
        });
    }

    // Apply translations to all UI elements
    function applyTranslations() {
        const t = translations[currentLang];
        document.getElementById('appTitle').innerText = t.appTitle;
        document.getElementById('songCount').innerHTML = t.songCount + (navigator.onLine ? '' : ' (Offline)');
        document.getElementById('searchInput').placeholder = t.searchPlaceholder;
        const filterSelect = document.getElementById('sectionFilter');
        filterSelect.options[0].text = t.filterPlaceholder;
        document.getElementById('resetBtn').innerText = t.reset;
        document.getElementById('allSectionsTitle').innerText = t.allSectionsTitle;
        document.getElementById('adminCardTitle').innerHTML = t.adminCardTitle;
        document.getElementById('adminCardDesc').innerText = t.adminCardDesc;
        document.getElementById('adminBtnText').innerText = t.adminBtnText;
        document.getElementById('contactCardTitle').innerHTML = t.contactCardTitle;
        document.getElementById('contactCardDesc').innerText = t.contactCardDesc;
        document.getElementById('contactBtnText').innerText = t.contactBtnText;
        document.getElementById('contactInfoText').innerHTML = t.contactInfo.replace(/\n/g, '<br>');
        document.getElementById('modalTitle').innerText = t.modalTitle;
        document.getElementById('contactEmail').placeholder = t.emailPlaceholder;
        document.getElementById('contactMessage').placeholder = t.messagePlaceholder;
        document.getElementById('sendBtn').innerText = t.send;
        document.getElementById('closeBtn').innerText = t.close;
    }

    // ========== FULL SECTIONS DISPLAY (ALL 24+ SECTIONS) ==========
    function displayAllSections() {
        const sections = [
            'Gutangira', 'Nyagasani Tubabarire', 'Imana nisingizwe mu ijuru',
            'Zaburi', 'Alleluya', 'Indanga kwemera', 'Ibisabisho', 'Gutura',
            'Nyirubutagatifu', 'Ntama w\'Imana', 'Gusangira', 'Gushimira',
            'Gusoza', 'Bikiramariya', 'Abatagatifu bose', 'Gushyingirwa',
            'Ibitaramo', 'Adiventi', 'Noheli', 'Igisibo', 'Pasika', 'Asensiyo',
            'Rohomutagatifu', 'Other More songs'
        ];
        const grid = document.getElementById('sectionsGrid');
        grid.innerHTML = '';
        sections.forEach(section => {
            const badge = document.createElement('div');
            badge.className = 'section-badge';
            badge.innerText = section;
            grid.appendChild(badge);
        });
    }

    // ========== CONTACT MODAL FUNCTIONS (FIXED) ==========
    window.showContactModal = function() {
        document.getElementById('contactModal').style.display = 'flex';
    };
    window.closeContactModal = function() {
        document.getElementById('contactModal').style.display = 'none';
    };
    window.sendMessage = function() {
        const email = document.getElementById('contactEmail').value;
        const message = document.getElementById('contactMessage').value;
        if (!email || !message) {
            alert(translations[currentLang].messagePlaceholder + ' ?');
            return;
        }
        // Store in localStorage (admin dashboard will read)
        const msgs = JSON.parse(localStorage.getItem('contactMessages') || '[]');
        msgs.push({ email, message, time: new Date().toLocaleString() });
        localStorage.setItem('contactMessages', JSON.stringify(msgs));
        alert(translations[currentLang].messageSent);
        closeContactModal();
        document.getElementById('contactEmail').value = '';
        document.getElementById('contactMessage').value = '';
    };
    window.hidePWANotification = function() {
        document.getElementById('pwaNotification').style.display = 'none';
    };

    // ========== ORIGINAL APP FUNCTIONS (PRESERVED) ==========
    let allSongs = [];
    let currentSearchTerm = '';
    
    function initApp() {
        loadSongs();
        createNavigation();
        displayAllSections(); // Show full sections list
        applyTranslations();
        // Set active lang button
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.lang === currentLang);
        });
    }
    
    function loadSongs() {
        allSongs = JSON.parse(localStorage.getItem('catholicSongs') || '[]');
        updateSongCount();
        displayAllSongs();
    }
    
    function updateSongCount() {
        const countEl = document.getElementById('songCount');
        if (countEl) {
            let text = `${translations[currentLang].songCount} | Indirimbo: ${allSongs.length}`;
            if (!navigator.onLine) text += ' (Offline)';
            countEl.innerHTML = text;
        }
    }
    
    function displayAllSongs() {
        const container = document.getElementById('sectionsContainer');
        if (allSongs.length === 0) {
            container.innerHTML = `<div class="section active"><h2>Indirimbo</h2><div class="no-songs"><p>Nta ndirimbo zishyizweho.</p><p>Admin azazishyiramo mu gihe gito.</p></div></div>`;
            return;
        }
        // Group by section
        const sections = {};
        allSongs.forEach(song => { if (!sections[song.section]) sections[song.section] = []; sections[song.section].push(song); });
        let html = '';
        for (const [sectionName, sectionSongs] of Object.entries(sections)) {
            html += `<div class="section" id="section-${sectionName.replace(/\s+/g, '-')}"><h2>${sectionName} (${sectionSongs.length})</h2><div class="songs-list">`;
            sectionSongs.forEach(song => {
                html += `<div class="song"><div class="song-header"><h3 class="song-title">${song.title}</h3><span class="song-date">${song.dateAdded || 'Vuba'}</span></div>
                        <div class="song-meta"><span class="song-section">${song.section}</span><span class="song-size">${song.fileSize || 'NTA'}</span>
                        <span class="download-count">üîΩ ${song.downloadCount || 0}</span></div>
                        <div class="song-actions"><button class="download-btn" onclick="downloadSong('${song.id}')"><span>‚¨áÔ∏è</span> Download</button>
                        <button class="play-btn" onclick="previewSong('${song.id}')"><span>üëÅÔ∏è</span> Reba</button></div></div>`;
            });
            html += `</div></div>`;
        }
        container.innerHTML = html;
        if (Object.keys(sections).length > 0) showSection(Object.keys(sections)[0]);
    }
    
    function createNavigation() {
        const sections = [
            'Gutangira', 'Nyagasani Tubabarire', 'Imana nisingizwe mu ijuru',
            'Zaburi', 'Alleluya', 'Indanga kwemera', 'Ibisabisho', 'Gutura',
            'Nyirubutagatifu', 'Ntama w\'Imana', 'Gusangira', 'Gushimira',
            'Gusoza', 'Bikiramariya', 'Abatagatifu bose', 'Gushyingirwa',
            'Ibitaramo', 'Adiventi', 'Noheli', 'Igisibo', 'Pasika', 'Asensiyo',
            'Rohomutagatifu', 'Other More songs'
        ];
        const nav = document.getElementById('sectionNav');
        nav.innerHTML = '';
        sections.forEach(section => {
            const btn = document.createElement('button');
            btn.textContent = section;
            btn.onclick = () => showSection(section);
            nav.appendChild(btn);
        });
    }
    
    function showSection(sectionName) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        const section = document.getElementById(`section-${sectionName.replace(/\s+/g, '-')}`);
        if (section) section.classList.add('active');
    }
    
    // Stub functions (original)
    window.searchSongs = function() { console.log('search'); };
    window.filterBySection = function() { console.log('filter'); };
    window.clearFilters = function() { 
        document.getElementById('searchInput').value = '';
        document.getElementById('sectionFilter').value = '';
        displayAllSongs();
    };
    window.downloadSong = function(id) { console.log('download', id); };
    window.previewSong = function(id) { console.log('preview', id); };
    
    // Initialize
    window.onload = function() {
        initApp();
    };
</script>
</body>
</html>
